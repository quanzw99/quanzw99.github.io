<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Ray Tracing in One Weekend - 1 | Quanzw's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script src="https://www.googletagmanager.com/gtag/js?id=G-PH7R3FX4D4" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PH7R3FX4D4');
</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.1.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Ray Tracing in One Weekend - 1</h1><a id="logo" href="/.">Quanzw's Blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/tags/"><i class="fa fa-tag"> tag</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Ray Tracing in One Weekend - 1</h1><div class="post-meta">2023-07-19</div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output-an-Image"><span class="toc-number">2.</span> <span class="toc-text">Output an Image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-PPM-Image-Format"><span class="toc-number">2.1.</span> <span class="toc-text">The PPM Image Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-an-Image-File"><span class="toc-number">2.2.</span> <span class="toc-text">Creating an Image File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-a-Progress-Indicator"><span class="toc-number">2.3.</span> <span class="toc-text">Adding a Progress Indicator</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-vec3-class"><span class="toc-number">3.</span> <span class="toc-text">The vec3 class</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Variables-and-Methods"><span class="toc-number">3.1.</span> <span class="toc-text">Variables and Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vec3-Utility-Functions"><span class="toc-number">3.2.</span> <span class="toc-text">vec3 Utility Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Color-Utility-Functions"><span class="toc-number">3.3.</span> <span class="toc-text">Color Utility Functions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rays-a-Simple-Camera-and-Background"><span class="toc-number">4.</span> <span class="toc-text">Rays, a Simple Camera, and Background</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-ray-Class"><span class="toc-number">4.1.</span> <span class="toc-text">The ray Class</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sending-Rays-Into-the-Scene"><span class="toc-number">4.2.</span> <span class="toc-text">Sending Rays Into the Scene</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol></div></div><div class="post-content"><p>《Ray Tracing in One Weekend》是Peter Shirley的Ray Tracing三部曲中的第一本。本节是阅读<a target="_blank" rel="noopener" href="https://raytracing.github.io/books/RayTracingInOneWeekend.html">Ray Tracing in One Weekend</a>时所做的笔记，当前的版本是3.2.3。主要目的是对Ray Tracing有个基本概念的认知，实验代码已上传至我的<a target="_blank" rel="noopener" href="https://github.com/quanzw99/RayTracing">仓库</a>。</p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>当大家提起<code>Ray Tracing</code>时，可能指不同的东西。而在这里，<code>Ray Tracing</code>是指<code>Path Tracer</code>，这也是最常见的释义。</p>
<p>我在<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/444405898">什么是Ray-Tracing(光线追踪)技术</a>中，找到了一个容易理解的描述: <u>光线追踪是一种渲染技术，其算法可以跟踪光的传播路径，模拟光源的各个方面以及光在三维环境中发生的反射，漫射，折射等特性，生成更逼真的渲染场景。</u></p>
<p>本书会带领我们一步步的实现一个<code>Ray Tracing</code>, 最后会得到一个能渲染出漂亮图片的光线追踪器。一些关于本书的额外的资源被上传到这个<a target="_blank" rel="noopener" href="https://in1weekend.blogspot.com/">网站</a>中。</p>
<h2 id="Output-an-Image"><a href="#Output-an-Image" class="headerlink" title="Output an Image"></a>Output an Image</h2><h3 id="The-PPM-Image-Format"><a href="#The-PPM-Image-Format" class="headerlink" title="The PPM Image Format"></a>The PPM Image Format</h3><p>在我们开始写renderer前，我们需要能够看到我们渲染出来的文件。有很多种图片格式，也都挺复杂的。所以我们可以从ppm文件开始。以下是wiki对ppm的介绍：</p>
<p><img src="fig-1.01-ppm.jpg" alt="Figure 1: ppm例子"></p>
<p>以下代码用于生成一个简单的ppm文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// Image</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> image_width = <span class="number">256</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> image_height = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Render</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"P3\n"</span> &lt;&lt; image_width &lt;&lt; <span class="string">" "</span> &lt;&lt; image_height &lt;&lt; <span class="string">"\n255\n"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = image_height<span class="number">-1</span>; j &gt;= <span class="number">0</span>; --j) {</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; image_width; i++) {</span><br><span class="line">            <span class="keyword">auto</span> r = <span class="built_in">double</span>(i) / (image_width<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">auto</span> g = <span class="built_in">double</span>(j) / (image_height<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">auto</span> b = <span class="number">0.25</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> ir = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(<span class="number">255.999</span> * r);</span><br><span class="line">            <span class="type">int</span> ig = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(<span class="number">255.999</span> * g);</span><br><span class="line">            <span class="type">int</span> ib = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(<span class="number">255.999</span> * b);</span><br><span class="line"></span><br><span class="line">            std::cout &lt;&lt; ir &lt;&lt; <span class="string">' '</span> &lt;&lt; ig &lt;&lt; <span class="string">' '</span> &lt;&lt; ib &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ul>
<li>以上代码的像素点，每行从左往右写；</li>
<li>以上代码的像素点，每列从上往下写；</li>
<li>颜色值范围被约定为(0.0 , 1.0], 这个约定在后续处理中不会被改变，即使在内部使用了high dynamic range。</li>
<li>下方的红色从左到右由黑到红，左侧的绿色从上到下由黑到绿，右上角应该是黄色。</li>
</ul>
<h3 id="Creating-an-Image-File"><a href="#Creating-an-Image-File" class="headerlink" title="Creating an Image File"></a>Creating an Image File</h3><p>现在只需要将cout流重定向到文件中即可，我们用<code>&gt;</code>来重定向输出流。<br>在windows中命令如下：<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inOneWeekend.exe &gt; image.ppm</span><br></pre></td></tr></table></figure></p>
<p>windows下如果找不到合适的软件打开ppm格式，可以使用<a target="_blank" rel="noopener" href="https://www.cs.rhodes.edu/welshc/COMP141_F16/ppmReader.html">ppm viewer</a>在线查看。</p>
<p>注：翻看原仓库的图片时发现原作者用的也是png格式，所以blog里贴都是实验截图。</p>
<p>生成图像如下：<br><img src="img-1.01-first-ppm-image.png" alt=""></p>
<h3 id="Adding-a-Progress-Indicator"><a href="#Adding-a-Progress-Indicator" class="headerlink" title="Adding a Progress Indicator"></a>Adding a Progress Indicator</h3><p>加入一个进度条来查看程序是否进入死循环是个好办法。<br>图片信息的写入使用标准流<code>std::cout</code>，所以我们使用<code>std::cerr</code>来输出进度。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::cerr &lt;&lt; <span class="string">"\rScanlines remaining: "</span> &lt;&lt; j &lt;&lt; <span class="string">' '</span> &lt;&lt; std::flush;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">"\nDone!\n"</span>;</span><br></pre></td></tr></table></figure>
<h2 id="The-vec3-class"><a href="#The-vec3-class" class="headerlink" title="The vec3 class"></a>The vec3 class</h2><p>几乎所有图形学的程序都有这样的class来存储geometric vetors和coloes。在很多系统中都使用了4维的向量（3D plus a homogeneous coordinate for geometry, and RGB plus an alpha transparency channel for colors)。在我们的场景下，三维足够了。我们用<code>vec</code>这个类来存储颜色，位置，方向，偏移量等等。有些人不太喜欢，因为它不能避免你做蠢事，比如颜色和位置相加。他们想得有道理，但当没有明显错误时，我们尽量精简代码。尽管如此，我们还是给<code>vec3</code>两个aliases:<code>point3</code>和<code>color</code>。因为这两种给类型只是<code>vec3</code>的别名，所以当你将color传递给期待points3的函数时，也不会有警告。我们使用他们是为了明确意图和用法。</p>
<h3 id="Variables-and-Methods"><a href="#Variables-and-Methods" class="headerlink" title="Variables and Methods"></a>Variables and Methods</h3><p>第一小节创建了vec3类，并在类中重载了一些运算符，例如<code>-</code>, <code>+=</code>, <code>*=</code>等等。</p>
<h3 id="vec3-Utility-Functions"><a href="#vec3-Utility-Functions" class="headerlink" title="vec3 Utility Functions"></a>vec3 Utility Functions</h3><p>第二小节中在类外，也重载vec3了一些运算符。如<code>&lt;&lt;</code>, <code>+/-/*/\</code>, <code>dot</code>, <code>cross</code>等等。</p>
<h3 id="Color-Utility-Functions"><a href="#Color-Utility-Functions" class="headerlink" title="Color Utility Functions"></a>Color Utility Functions</h3><p>第三小节为vec3类写了一个输出单个像素点颜色的方法，并在<code>main.cc</code>中使用这种方法来输出像素点。</p>
<h2 id="Rays-a-Simple-Camera-and-Background"><a href="#Rays-a-Simple-Camera-and-Background" class="headerlink" title="Rays, a Simple Camera, and Background"></a>Rays, a Simple Camera, and Background</h2><h3 id="The-ray-Class"><a href="#The-ray-Class" class="headerlink" title="The ray Class"></a>The ray Class</h3><p>所有的ray tracer都会有一个ray类并计算沿光线所见的颜色。我们用一个方程<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="14.238ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6293 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D477" d="M162 62L302 623Q302 624 258 624H234Q214 624 209 626T200 638Q200 677 217 684Q220 686 439 686Q667 685 684 682Q686 681 693 680Q713 677 733 671T782 649T829 602T847 528Q847 450 784 382T604 293Q571 288 469 287H373L346 176Q340 151 333 122T321 78L317 64Q317 62 361 62H387Q420 62 420 44Q417 10 404 2L399 0L357 1Q331 2 224 2Q149 2 109 1T65 0Q43 0 43 17Q43 21 47 33Q52 54 57 58T89 62H113H162ZM692 558Q692 611 617 622Q610 623 529 624H452L381 343H458H492Q604 343 641 389Q662 414 677 471T692 558Z"></path></g><g data-mml-node="mo" transform="translate(847,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1236,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1597,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2263.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3319.6,0)"><path data-c="1D468" d="M65 0Q45 0 45 18Q48 52 61 60Q65 62 81 62Q155 62 165 74Q166 74 265 228T465 539T569 699Q576 707 583 709T611 711T637 710T649 700Q650 697 695 380L741 63L784 62H827Q839 50 839 45L835 29Q831 9 827 5T806 0Q803 0 790 0T743 1T657 2Q585 2 547 1T504 0Q481 0 481 17Q484 54 497 60Q501 62 541 62Q580 62 580 63Q580 68 573 121T564 179V181H308L271 124Q236 69 236 67T283 62H287Q316 62 316 46Q316 26 307 8Q302 3 295 0L262 1Q242 2 168 2Q119 2 93 1T65 0ZM537 372Q533 402 528 435T521 486T518 504V505Q517 505 433 375L348 244L451 243Q555 243 555 244L537 372Z"></path></g><g data-mml-node="mo" transform="translate(4410.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(5411,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(5772,0)"><path data-c="1D483" d="M220 -8Q142 -8 94 35T45 155V167Q45 187 52 218T104 426L153 622H149Q148 622 144 622T134 623T122 624T111 624T101 624T96 625Q84 628 84 642Q84 647 88 661T94 679Q98 684 109 685T185 690Q258 694 272 694Q289 694 293 679Q293 676 263 553L232 429L244 434Q256 440 281 446T331 452Q417 452 465 407T513 285Q513 235 494 184T439 90T346 20T220 -8ZM385 337Q385 400 318 400Q269 400 226 360Q214 349 211 341T191 268Q162 149 162 113Q162 44 226 44Q269 44 299 76T339 135T362 215Q364 222 365 226Q385 303 385 337Z"></path></g></g></g></svg></mjx-container>来定义ray。其中<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.916ex" height="1.552ex" role="img" focusable="false" viewBox="0 -686 847 686"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D477" d="M162 62L302 623Q302 624 258 624H234Q214 624 209 626T200 638Q200 677 217 684Q220 686 439 686Q667 685 684 682Q686 681 693 680Q713 677 733 671T782 649T829 602T847 528Q847 450 784 382T604 293Q571 288 469 287H373L346 176Q340 151 333 122T321 78L317 64Q317 62 361 62H387Q420 62 420 44Q417 10 404 2L399 0L357 1Q331 2 224 2Q149 2 109 1T65 0Q43 0 43 17Q43 21 47 33Q52 54 57 58T89 62H113H162ZM692 558Q692 611 617 622Q610 623 529 624H452L381 343H458H492Q604 343 641 389Q662 414 677 471T692 558Z"></path></g></g></g></svg></mjx-container>是三维空间中的一条直线上的点。<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.966ex" height="1.609ex" role="img" focusable="false" viewBox="0 -711 869 711"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D468" d="M65 0Q45 0 45 18Q48 52 61 60Q65 62 81 62Q155 62 165 74Q166 74 265 228T465 539T569 699Q576 707 583 709T611 711T637 710T649 700Q650 697 695 380L741 63L784 62H827Q839 50 839 45L835 29Q831 9 827 5T806 0Q803 0 790 0T743 1T657 2Q585 2 547 1T504 0Q481 0 481 17Q484 54 497 60Q501 62 541 62Q580 62 580 63Q580 68 573 121T564 179V181H308L271 124Q236 69 236 67T283 62H287Q316 62 316 46Q316 26 307 8Q302 3 295 0L262 1Q242 2 168 2Q119 2 93 1T65 0ZM537 372Q533 402 528 435T521 486T518 504V505Q517 505 433 375L348 244L451 243Q555 243 555 244L537 372Z"></path></g></g></g></svg></mjx-container>是ray的起点，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.018ex;" xmlns="http://www.w3.org/2000/svg" width="1.179ex" height="1.588ex" role="img" focusable="false" viewBox="0 -694 521 702"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D483" d="M220 -8Q142 -8 94 35T45 155V167Q45 187 52 218T104 426L153 622H149Q148 622 144 622T134 623T122 624T111 624T101 624T96 625Q84 628 84 642Q84 647 88 661T94 679Q98 684 109 685T185 690Q258 694 272 694Q289 694 293 679Q293 676 263 553L232 429L244 434Q256 440 281 446T331 452Q417 452 465 407T513 285Q513 235 494 184T439 90T346 20T220 -8ZM385 337Q385 400 318 400Q269 400 226 360Q214 349 211 341T191 268Q162 149 162 113Q162 44 226 44Q269 44 299 76T339 135T362 215Q364 222 365 226Q385 303 385 337Z"></path></g></g></g></svg></mjx-container>是ray的方向。参数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>是一个实数（在代码中是double）。传入不同的<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>使得<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.493ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1986 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D477" d="M162 62L302 623Q302 624 258 624H234Q214 624 209 626T200 638Q200 677 217 684Q220 686 439 686Q667 685 684 682Q686 681 693 680Q713 677 733 671T782 649T829 602T847 528Q847 450 784 382T604 293Q571 288 469 287H373L346 176Q340 151 333 122T321 78L317 64Q317 62 361 62H387Q420 62 420 44Q417 10 404 2L399 0L357 1Q331 2 224 2Q149 2 109 1T65 0Q43 0 43 17Q43 21 47 33Q52 54 57 58T89 62H113H162ZM692 558Q692 611 617 622Q610 623 529 624H452L381 343H458H492Q604 343 641 389Q662 414 677 471T692 558Z"></path></g><g data-mml-node="mo" transform="translate(847,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1236,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1597,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>返回ray上对应的点。若<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>可以取负值，则可以得到整条直线。若<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>只取正值，则只能得到<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.966ex" height="1.609ex" role="img" focusable="false" viewBox="0 -711 869 711"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D468" d="M65 0Q45 0 45 18Q48 52 61 60Q65 62 81 62Q155 62 165 74Q166 74 265 228T465 539T569 699Q576 707 583 709T611 711T637 710T649 700Q650 697 695 380L741 63L784 62H827Q839 50 839 45L835 29Q831 9 827 5T806 0Q803 0 790 0T743 1T657 2Q585 2 547 1T504 0Q481 0 481 17Q484 54 497 60Q501 62 541 62Q580 62 580 63Q580 68 573 121T564 179V181H308L271 124Q236 69 236 67T283 62H287Q316 62 316 46Q316 26 307 8Q302 3 295 0L262 1Q242 2 168 2Q119 2 93 1T65 0ZM537 372Q533 402 528 435T521 486T518 504V505Q517 505 433 375L348 244L451 243Q555 243 555 244L537 372Z"></path></g></g></g></svg></mjx-container>点前面的部分，通常说是半条直线或者射线。<br><img src="fig-1.02-lerp.jpg" alt="Figure 2: 线性插值"></p>
<p>函数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.493ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1986 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D477" d="M162 62L302 623Q302 624 258 624H234Q214 624 209 626T200 638Q200 677 217 684Q220 686 439 686Q667 685 684 682Q686 681 693 680Q713 677 733 671T782 649T829 602T847 528Q847 450 784 382T604 293Q571 288 469 287H373L346 176Q340 151 333 122T321 78L317 64Q317 62 361 62H387Q420 62 420 44Q417 10 404 2L399 0L357 1Q331 2 224 2Q149 2 109 1T65 0Q43 0 43 17Q43 21 47 33Q52 54 57 58T89 62H113H162ZM692 558Q692 611 617 622Q610 623 529 624H452L381 343H458H492Q604 343 641 389Q662 414 677 471T692 558Z"></path></g><g data-mml-node="mo" transform="translate(847,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1236,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1597,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>在更冗长（复杂）的代码形式中写作ray::at(t)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> RAY_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RAY_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">"vec3.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ray</span>{</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">ray</span>() {}</span><br><span class="line">        <span class="built_in">ray</span>(<span class="type">const</span> vec3&amp; origin, <span class="type">const</span> vec3&amp; direction)</span><br><span class="line">            : <span class="built_in">orig</span>(origin), <span class="built_in">dir</span>(direction)</span><br><span class="line">        {}</span><br><span class="line"></span><br><span class="line">        <span class="function">vec3 <span class="title">origin</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> orig; }</span><br><span class="line">        <span class="function">vec3 <span class="title">direction</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> dir; }</span><br><span class="line"></span><br><span class="line">        <span class="function">vec3 <span class="title">at</span><span class="params">(<span class="type">double</span> t)</span> <span class="type">const</span> </span>{</span><br><span class="line">            <span class="keyword">return</span> orig + t * dir;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        vec3 orig;</span><br><span class="line">        vec3 dir;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Sending-Rays-Into-the-Scene"><a href="#Sending-Rays-Into-the-Scene" class="headerlink" title="Sending Rays Into the Scene"></a>Sending Rays Into the Scene</h3><p>现在我们可以绕回来做我们的ray tracer。本质上，ray tracer通过像素发射ray，并计算沿着这些ray的方向所见的颜色。这包括以下几个步骤：</p>
<ol>
<li>计算从视点到像素的ray。这里的视点指的是ray tracer的观察点或者相机位置。在ray tracer中我们模拟了现实中的相机，该相机位于场景中的某个位置，通过这个位置来观察场景;</li>
<li>确定光线与哪个物体相交(intersects);</li>
<li>计算相交点(intersection point)的颜色。</li>
</ol>
<p>在初步开发Ray tracer时，我们通常实现一个简单的相机，以便代码快点跑起来。我还会编写一个简单的<code>ray_color(ray)</code>函数，用于返回背景的颜色(一个简单的渐变色)。</p>
<p>我在调试正方形的图像时常常遇到麻烦，因为我总是混淆x和y，所以我们使用非正方形的图像。现在我们使用16:9的宽高比，因为这是常见的比例。</p>
<p>除了为渲染图像设置像素尺寸外，我们还需要设置一个virtual viewport(虚拟视口)，通过这个viewport传递我们的场景光线。对于标准的正方形的像素点，viewport的宽高比应与渲染图像的相同。我们将选择一个高度为两个unit的视口。我们还将设置投影平面和投影点之间的距离为一个unit。这被称为<code>focal length - 焦距</code>，不要和后面要介绍的<code>focus distance - 焦点距离</code>混淆。</p>
<p>我将把”eye”（视点）（如果你认为是相机的话，就是相机中心）放在坐标(0, 0, 0)处。我让y轴朝上，x轴朝右。为了符合右手坐标系，负z轴的方向指向屏幕。我从屏幕的左上角开始遍历，并使用两个偏移向量沿着屏幕的边缘移动光线的终点位置。请注意，这里我没有将光线的方向向量归一化为单位长度，因为我认为这样会使代码更简单，而且稍微快一点。</p>
<p><img src="fig-1.03-cam-geom.jpg" alt="Figure 3: 相机几何学"></p>
<p>在下面的代码中，ray会大约指向像素中心（暂时不用担心精度问题，之后我们会添加<code>antialiasing</code>（反走样））。</p>
<p><code>ray_color(ray)</code>函数根据y值将蓝色白色做了线性混合，我们这里把ray的方向做了单位化，以保证y的取值范围(-1.0 &lt; y &lt; 1.0)。因为我们是在对向量进行归一化后查看y坐标，所以除了垂直渐变之外，还应该会有水平渐变。（这里画个图计算一下同一水平上的两个点和origin构成的向量被单位化之后的y值就可以理解了）</p>
<p>然后我使用了一个技巧将t的范围缩放到(0.0 &lt; y &lt; 1.0)。当t = 1.0时，我想要蓝色。当t = 0 的时候，我想要白色。在两者之间就得到混合色。这就形成了两者之间的一个<code>linear blend</code>或者<code>linear interpolation</code>或者简写为<code>lerp</code>。<code>lerp</code>的表达式常如以下形式：</p>
<script type="math/tex; mode=display">
blendedValue = (1 - t) \cdot startValue + t \cdot endValue</script><p>当t从0到1变化时，我们得到以下图像：<br><img src="img-1.02-blue-to-white.png" alt=""></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/RayTracing/raytracing.github.io">Ray Tracing in One Weekend Book Series</a></li>
<li><a target="_blank" rel="noopener" href="https://raytracing.github.io/books/RayTracingInOneWeekend.html">Ray Tracing in One Weekend</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/128582904">Ray Tracing in One Weekend V3.0中文翻译（上）</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/128685960">Ray Tracing in One Weekend V3.0中文翻译（下）</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/88369641">Ray Tracing in one Weekend中文翻译，《手写光追，立马光追》</a></li>
</ul>
</div><div class="tags"><a href="/tags/#Graphics"><i class="fa fa-tag">Graphics</i></a></div><div class="post-nav"><a class="pre" href="/2023/07/21/Paper-Reading-0/">Paper Reading 0 - How to read research papers?</a><a class="next" href="/2023/07/17/Introduction-of-Interpreter/">Introduction of Interpreter</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CS/">CS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Summary/">Summary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/09/09/Paper-Reading-2/">Paper Reading 2 - Vulkan-Sim:A GPU Archtecture Simulator for Ray Tracing</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/09/05/Install-GPGPU-Sim/">Install GPGPU-Sim</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/08/21/Install-Ubuntu/">Install Ubuntu</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/08/15/Index-for-Graphics-Hardware/">Index for Graphics Hardware</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/08/12/Index-for-Leetcode/">Index for Leetcode</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/08/12/Leetcode-1071-Greatest-Common-Divisor-of-Strings/">Leetcode 1071 - Greatest Common Divisor of Strings</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/08/12/Common-Syntax-in-STL/">Common Syntax in STL</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/07/25/Ray-Tracing-in-One-Weekend-2/">Ray Tracing in One Weekend - 2</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/07/24/Paper-Reading-1/">Paper Reading 1 - Intersection Prediction for Accelerated GPU Ray Tracing</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/07/21/Paper-Reading-0/">Paper Reading 0 - How to read research papers?</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://www.haomwei.com/technology/maupassant-hexo.html#%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE" title="Maupassant Config" target="_blank">Maupassant Config</a><ul></ul><a href="https://hexo.io/docs/configuration.html" title="Hexo Docs" target="_blank">Hexo Docs</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Quanzw's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>